"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var mobx=require("../../../mobx/lib/mobx.js"),Taro=_interopDefault(require("../../taro/index.js"));function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.forEach(function(e){_defineProperty(r,e,t[e])})}return r}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_nonIterableRest()}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArrayLimit(e,r){var t=[],n=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(t.push(i.value),!r||t.length!==r);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return t}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var EventEmitter=function(){function e(){_classCallCheck(this,e),_defineProperty(this,"listeners",[])}return _createClass(e,[{key:"on",value:function(r){var t=this;return this.listeners.push(r),function(){var e=t.listeners.indexOf(r);-1!==e&&t.listeners.splice(e,1)}}},{key:"emit",value:function(r){this.listeners.forEach(function(e){return e(r)})}}]),e}(),errorsReporter=new EventEmitter;function createChainableTypeChecker(u){function e(r,t,n,o,a,i){for(var e=arguments.length,c=new Array(6<e?e-6:0),s=6;s<e;s++)c[s-6]=arguments[s];return mobx.untracked(function(){if(o=o||"<<anonymous>>",i=i||n,null!=t[n])return u.apply(void 0,[t,n,o,a,i].concat(c));if(r){var e=null===t[n]?"null":"undefined";return new Error("The "+a+" `"+i+"` is marked as required in `"+o+"`, but its value is `"+e+"`.")}return null})}var r=e.bind(null,!1);return r.isRequired=e.bind(null,!0),r}function isSymbol(e,r){return"symbol"===e||("Symbol"===r["@@toStringTag"]||"function"==typeof Symbol&&r instanceof Symbol)}function getPropType(e){var r=_typeof(e);return Array.isArray(e)?"array":e instanceof RegExp?"object":isSymbol(r,e)?"symbol":r}function getPreciseType(e){var r=getPropType(e);if("object"===r){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return r}function createObservableTypeCheckerCreator(s,u){return createChainableTypeChecker(function(o,a,i,e,c){return mobx.untracked(function(){if(s&&getPropType(o[a])===u.toLowerCase())return null;var e;switch(u){case"Array":e=mobx.isObservableArray;break;case"Object":e=mobx.isObservableObject;break;case"Map":e=mobx.isObservableMap;break;default:throw new Error("Unexpected mobxType: ".concat(u))}var r=o[a];if(e(r))return null;var t=getPreciseType(r),n=s?" or javascript `"+u.toLowerCase()+"`":"";return new Error("Invalid prop `"+c+"` of type `"+t+"` supplied to `"+i+"`, expected `mobx.Observable"+u+"`"+n+".")})})}function createObservableArrayOfTypeChecker(u,l){return createChainableTypeChecker(function(n,o,a,i,c){for(var e=arguments.length,s=new Array(5<e?e-5:0),r=5;r<e;r++)s[r-5]=arguments[r];return mobx.untracked(function(){if("function"!=typeof l)return new Error("Property `"+c+"` of component `"+a+"` has invalid PropType notation.");var e=createObservableTypeCheckerCreator(u,"Array")(n,o,a);if(e instanceof Error)return e;for(var r=n[o],t=0;t<r.length;t++)if((e=l.apply(void 0,[r,t,a,i,c+"["+t+"]"].concat(s)))instanceof Error)return e;return null})})}var observableArray=createObservableTypeCheckerCreator(!1,"Array"),observableArrayOf=createObservableArrayOfTypeChecker.bind(null,!1),observableMap=createObservableTypeCheckerCreator(!1,"Map"),observableObject=createObservableTypeCheckerCreator(!1,"Object"),arrayOrObservableArray=createObservableTypeCheckerCreator(!0,"Array"),arrayOrObservableArrayOf=createObservableArrayOfTypeChecker.bind(null,!0),objectOrObservableObject=createObservableTypeCheckerCreator(!0,"Object"),PropTypes={observableArray:observableArray,observableArrayOf:observableArrayOf,observableMap:observableMap,observableObject:observableObject,arrayOrObservableArray:arrayOrObservableArray,arrayOrObservableArrayOf:arrayOrObservableArrayOf,objectOrObservableObject:objectOrObservableObject};function isPlainObject(e){if(!e||"object"!==_typeof(e))return!1;var r=Object.getPrototypeOf(e);return!r||r===Object.prototype}function isMiniPlatform(){return!/^WEB|RN$/i.test(Taro.getEnv())}var globalIsUsingStaticRendering=!1;function useStaticRendering(e){globalIsUsingStaticRendering=e}function isUsingStaticRendering(){return globalIsUsingStaticRendering}function observer(e){if(isUsingStaticRendering())return e;!0===e.isMobxInjector&&console.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'");var r=e.prototype,t=r.componentWillMount,n=r.componentWillReact;r.componentWillMount=function(){var e=this,r=this.displayName||this.name;this._reaction=new mobx.Reaction("".concat(r,"_").concat(Date.now()),function(){e.forceUpdate(),n&&n.call(e)}),t&&t.call(this)};var o=r.componentWillUnmount;r.componentWillUnmount=function(){this._reaction.dispose(),o&&o.call(this)};var a=isMiniPlatform()?"_createData":"render",i=r[a];return r[a]=function(){for(var e,r,t=this,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];if(this._reaction instanceof mobx.Reaction?this._reaction.track(function(){try{e=i.call(t,null,null,o[2])}catch(e){r=e}}):e=i.call(this,null,null,o[2]),r)throw errorsReporter.emit(r),r;return e},e}function useAsObservableSourceInternal(e,r,t){if(!r||void 0!==e){var n=_slicedToArray(t(function(){return mobx.observable(e,{},{deep:!1})}),1)[0];return mobx.runInAction(function(){Object.assign(n,e)}),n}}function useAsObservableSource(e,r){return useAsObservableSourceInternal(e,!1,r)}function useLocalStore(e,r,t){var n=useAsObservableSourceInternal(r,!0,t);return t(function(){var t=mobx.observable(e(n));return isPlainObject(t)&&mobx.runInAction(function(){Object.keys(t).forEach(function(e){var r=t[e];"function"==typeof r&&(t[e]=wrapInTransaction(r,t))})}),t})[0]}function wrapInTransaction(n,o){return function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return mobx.transaction(function(){return n.apply(o,r)})}}var store={};function getStore(){return store}function setStore(e){store=e}function grabStoresByName(e){return function(t,n){return e.forEach(function(e){if(!(e in t)){var r=new Error("MobX injector: Store '"+e+"' is not available! Make sure it is provided by some Provider");throw errorsReporter.emit(r),r}n[e]=t[e]}),n}}function getInjectName(e,r){var t=e.displayName||e.name||"Component";return r?"inject-with-".concat(r,"(").concat(t,")"):"inject(".concat(t,")")}function mapStoreToProps(e,r){var t=_objectSpread({},r);return Object.assign(t,e(getStore()||{},t)||{})}function inject(){var r,t=arguments[arguments.length-1];if("function"==typeof arguments[0])return r=arguments[0],function(e){return t(r,null,e)};for(var n=[],e=0;e<arguments.length-1;e++)n[e]=arguments[e];return r=grabStoresByName(n),function(e){return t(r,n.join("-"),e)}}var onError=function(e){return errorsReporter.on(e)};exports.onError=onError,exports.PropTypes=PropTypes,exports.observer=observer,exports.useLocalStore=useLocalStore,exports.useAsObservableSource=useAsObservableSource,exports.isUsingStaticRendering=isUsingStaticRendering,exports.useStaticRendering=useStaticRendering,exports.getStore=getStore,exports.setStore=setStore,exports.inject=inject,exports.getInjectName=getInjectName,exports.mapStoreToProps=mapStoreToProps;